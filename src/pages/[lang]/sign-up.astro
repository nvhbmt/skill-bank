---
import DefaultLayout from '@/layouts/DefaultLayout.astro';
import OAuthButtons from '@/components/OAuthButtons.astro';
import '@/assets/css/sign-up.css';
import { getStaticPaths, useTranslate } from '@/i18n';
export { getStaticPaths };

const { lang, t, l } = useTranslate(Astro);
const isLoggedIn = Astro.locals.session?.user;
if (isLoggedIn) {
    return Astro.redirect(l('/'));
}
---

<DefaultLayout>
    <div class="container">
        <div class="login-page">
            <div class="login-page-left">
                <img src="/assets/images/logo.svg" alt="logo" class="logo" />
            </div>
            <div class="login-page-right">
                <div class="inner-login-page-right">
                    <form id="signup-form">
                        <div class="login-content">
                            <div class="login-form">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;"
                                >
                                    <h1>{t('sign-up.title')}</h1>
                                    <select
                                        id="lang-selector"
                                        style="padding: 0.5rem; border-radius: 4px; border: 1px solid #ccc;"
                                    >
                                        <option
                                            value="vi"
                                            selected={lang === 'vi'}>VI</option
                                        >
                                        <option
                                            value="en"
                                            selected={lang === 'en'}>EN</option
                                        >
                                    </select>
                                </div>
                                <div>
                                    {t('sign-up.haveAccount')}
                                    <a href={l('/sign-in')} class="login-link"
                                        >{t('sign-up.signIn')}</a
                                    >
                                </div>
                            </div>
                            <div class="login-form-body">
                                <div class="login-form-item-group">
                                    <div class="login-form-input-wrapper">
                                        <img
                                            src="/assets/images/solar_pen-outline.svg"
                                            alt="icon"
                                        />
                                        <input
                                            type="text"
                                            name="fullName"
                                            placeholder={t('sign-up.fullName')}
                                            class="login-form-group-text"
                                        />
                                    </div>
                                    <div
                                        id="fullName-error"
                                        class="login-form-input-error"
                                    >
                                    </div>
                                </div>
                                <div class="login-form-item-group">
                                    <div class="login-form-input-wrapper">
                                        <img
                                            src="/assets/images/solar_user-outline.svg"
                                            alt="icon"
                                        />
                                        <input
                                            type="text"
                                            name="username"
                                            placeholder={t('sign-up.username')}
                                            class="login-form-group-text"
                                        />
                                    </div>
                                    <div
                                        id="username-error"
                                        class="login-form-input-error"
                                    >
                                    </div>
                                </div>
                                <div class="login-form-item-group">
                                    <div class="login-form-input-wrapper">
                                        <img
                                            src="/assets/images/mdi-light_email.svg"
                                            alt="icon"
                                        />
                                        <input
                                            type="email"
                                            name="email"
                                            placeholder={t('sign-up.email')}
                                            class="login-form-group-text"
                                        />
                                    </div>
                                    <div
                                        id="email-error"
                                        class="login-form-input-error"
                                    >
                                    </div>
                                </div>
                                <div class="login-form-item-group">
                                    <div class="login-form-input-wrapper">
                                        <img
                                            src="/assets/images/material-symbols-light_lock-outline.svg"
                                            alt="icon"
                                        />
                                        <input
                                            type="password"
                                            name="password"
                                            placeholder={t('sign-up.password')}
                                            class="login-form-group-text"
                                        />
                                    </div>
                                    <div
                                        id="password-error"
                                        class="login-form-input-error"
                                    >
                                    </div>
                                </div>
                                <div class="login-form-action">
                                    <div
                                        style="display: flex; flex-direction: column; gap: 5px;"
                                    >
                                        <div
                                            style="display: flex; align-items: center; gap: 8px;"
                                        >
                                            <label
                                                style="display: flex; align-items: center; gap: 8px; cursor: pointer;"
                                            >
                                                <input
                                                    type="checkbox"
                                                    name="agree"
                                                />
                                                <span>{t('sign-up.agree')}</span
                                                >
                                            </label>
                                            <a
                                                href="/dieu-khoan-va-dieu-kien"
                                                class="login-link"
                                                >{
                                                    t(
                                                        'sign-up.TermsAndConditions'
                                                    )
                                                }</a
                                            >
                                        </div>
                                        <div
                                            id="agree-error"
                                            class="login-form-input-error"
                                        >
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="login-form-btn"
                                >{t('sign-up.title')}</button
                            >
                        </div>
                        <div class="login-form-divider">
                            <div class="login-form-divider-line"></div>
                            <div class="login-form-divider-text">
                                {t('sign-up.or')}
                            </div>
                            <div class="login-form-divider-line"></div>
                        </div>
                        <OAuthButtons
                            googleText={t('sign-up.gmail')}
                            facebookText={t('sign-up.facebook')}
                            errorGeneric={t('sign-up.errorGeneric')}
                        />
                    </form>
                </div>
            </div>
        </div>
    </div>
</DefaultLayout>

<script
    define:vars={{
        validationMessages: JSON.stringify({
            fullNameRequired: t('sign-up.validation.fullNameRequired'),
            fullNameMinLength: t('sign-up.validation.fullNameMinLength'),
            fullNameMaxLength: t('sign-up.validation.fullNameMaxLength'),
            usernameRequired: t('sign-up.validation.usernameRequired'),
            usernameMinLength: t('sign-up.validation.usernameMinLength'),
            usernameMaxLength: t('sign-up.validation.usernameMaxLength'),
            emailRequired: t('sign-up.validation.emailRequired'),
            emailInvalid: t('sign-up.validation.emailInvalid'),
            passwordRequired: t('sign-up.validation.passwordRequired'),
            passwordMinLength: t('sign-up.validation.passwordMinLength'),
            agreeRequired: t('sign-up.validation.agreeRequired'),
        }),
        uiMessages: JSON.stringify({
            loading: t('sign-up.loading'),
            error: t('sign-up.error'),
            errorGeneric: t('sign-up.errorGeneric'),
        }),
    }}
>
    window.signupValidationMessages = JSON.parse(validationMessages);
    window.signupUIMessages = JSON.parse(uiMessages);
</script>

<script src="@/assets/script/sign-up.js"></script>
